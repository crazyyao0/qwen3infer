#pragma once
#include<string>
#include<vector>
#include<map>

struct tensor_meta
{
    std::string dtype;
    std::vector<int> shape;
    unsigned long long data_offsets;
    unsigned long long data_length;
};

std::map<std::string, struct tensor_meta> model_weights_raw = {
{"attention_mask", {"BF16", {512,512,1}, 35600, 524288}},
{"model.embed_tokens.weight", {"BF16", {1024,151669}, 559888, 310618112}},
{"model.layers.0.input_layernorm.weight", {"BF16", {1024}, 311178000, 2048}},
{"model.layers.0.mlp.down_proj.weight", {"BF16", {3072,1024}, 311180048, 6291456}},
{"model.layers.0.mlp.gate_proj.weight", {"BF16", {1024,3072}, 317471504, 6291456}},
{"model.layers.0.mlp.up_proj.weight", {"BF16", {1024,3072}, 323762960, 6291456}},
{"model.layers.0.post_attention_layernorm.weight", {"BF16", {1024}, 330054416, 2048}},
{"model.layers.0.self_attn.k_norm.weight", {"BF16", {128}, 330056464, 256}},
{"model.layers.0.self_attn.k_proj.weight", {"BF16", {1024,1024}, 330056720, 2097152}},
{"model.layers.0.self_attn.o_proj.weight", {"BF16", {2048,1024}, 332153872, 4194304}},
{"model.layers.0.self_attn.q_norm.weight", {"BF16", {128}, 336348176, 256}},
{"model.layers.0.self_attn.q_proj.weight", {"BF16", {1024,2048}, 336348432, 4194304}},
{"model.layers.0.self_attn.v_proj.weight", {"BF16", {1024,1024}, 340542736, 2097152}},
{"model.layers.1.input_layernorm.weight", {"BF16", {1024}, 342639888, 2048}},
{"model.layers.1.mlp.down_proj.weight", {"BF16", {3072,1024}, 342641936, 6291456}},
{"model.layers.1.mlp.gate_proj.weight", {"BF16", {1024,3072}, 348933392, 6291456}},
{"model.layers.1.mlp.up_proj.weight", {"BF16", {1024,3072}, 355224848, 6291456}},
{"model.layers.1.post_attention_layernorm.weight", {"BF16", {1024}, 361516304, 2048}},
{"model.layers.1.self_attn.k_norm.weight", {"BF16", {128}, 361518352, 256}},
{"model.layers.1.self_attn.k_proj.weight", {"BF16", {1024,1024}, 361518608, 2097152}},
{"model.layers.1.self_attn.o_proj.weight", {"BF16", {2048,1024}, 363615760, 4194304}},
{"model.layers.1.self_attn.q_norm.weight", {"BF16", {128}, 367810064, 256}},
{"model.layers.1.self_attn.q_proj.weight", {"BF16", {1024,2048}, 367810320, 4194304}},
{"model.layers.1.self_attn.v_proj.weight", {"BF16", {1024,1024}, 372004624, 2097152}},
{"model.layers.10.input_layernorm.weight", {"BF16", {1024}, 374101776, 2048}},
{"model.layers.10.mlp.down_proj.weight", {"BF16", {3072,1024}, 374103824, 6291456}},
{"model.layers.10.mlp.gate_proj.weight", {"BF16", {1024,3072}, 380395280, 6291456}},
{"model.layers.10.mlp.up_proj.weight", {"BF16", {1024,3072}, 386686736, 6291456}},
{"model.layers.10.post_attention_layernorm.weight", {"BF16", {1024}, 392978192, 2048}},
{"model.layers.10.self_attn.k_norm.weight", {"BF16", {128}, 392980240, 256}},
{"model.layers.10.self_attn.k_proj.weight", {"BF16", {1024,1024}, 392980496, 2097152}},
{"model.layers.10.self_attn.o_proj.weight", {"BF16", {2048,1024}, 395077648, 4194304}},
{"model.layers.10.self_attn.q_norm.weight", {"BF16", {128}, 399271952, 256}},
{"model.layers.10.self_attn.q_proj.weight", {"BF16", {1024,2048}, 399272208, 4194304}},
{"model.layers.10.self_attn.v_proj.weight", {"BF16", {1024,1024}, 403466512, 2097152}},
{"model.layers.11.input_layernorm.weight", {"BF16", {1024}, 405563664, 2048}},
{"model.layers.11.mlp.down_proj.weight", {"BF16", {3072,1024}, 405565712, 6291456}},
{"model.layers.11.mlp.gate_proj.weight", {"BF16", {1024,3072}, 411857168, 6291456}},
{"model.layers.11.mlp.up_proj.weight", {"BF16", {1024,3072}, 418148624, 6291456}},
{"model.layers.11.post_attention_layernorm.weight", {"BF16", {1024}, 424440080, 2048}},
{"model.layers.11.self_attn.k_norm.weight", {"BF16", {128}, 424442128, 256}},
{"model.layers.11.self_attn.k_proj.weight", {"BF16", {1024,1024}, 424442384, 2097152}},
{"model.layers.11.self_attn.o_proj.weight", {"BF16", {2048,1024}, 426539536, 4194304}},
{"model.layers.11.self_attn.q_norm.weight", {"BF16", {128}, 430733840, 256}},
{"model.layers.11.self_attn.q_proj.weight", {"BF16", {1024,2048}, 430734096, 4194304}},
{"model.layers.11.self_attn.v_proj.weight", {"BF16", {1024,1024}, 434928400, 2097152}},
{"model.layers.12.input_layernorm.weight", {"BF16", {1024}, 437025552, 2048}},
{"model.layers.12.mlp.down_proj.weight", {"BF16", {3072,1024}, 437027600, 6291456}},
{"model.layers.12.mlp.gate_proj.weight", {"BF16", {1024,3072}, 443319056, 6291456}},
{"model.layers.12.mlp.up_proj.weight", {"BF16", {1024,3072}, 449610512, 6291456}},
{"model.layers.12.post_attention_layernorm.weight", {"BF16", {1024}, 455901968, 2048}},
{"model.layers.12.self_attn.k_norm.weight", {"BF16", {128}, 455904016, 256}},
{"model.layers.12.self_attn.k_proj.weight", {"BF16", {1024,1024}, 455904272, 2097152}},
{"model.layers.12.self_attn.o_proj.weight", {"BF16", {2048,1024}, 458001424, 4194304}},
{"model.layers.12.self_attn.q_norm.weight", {"BF16", {128}, 462195728, 256}},
{"model.layers.12.self_attn.q_proj.weight", {"BF16", {1024,2048}, 462195984, 4194304}},
{"model.layers.12.self_attn.v_proj.weight", {"BF16", {1024,1024}, 466390288, 2097152}},
{"model.layers.13.input_layernorm.weight", {"BF16", {1024}, 468487440, 2048}},
{"model.layers.13.mlp.down_proj.weight", {"BF16", {3072,1024}, 468489488, 6291456}},
{"model.layers.13.mlp.gate_proj.weight", {"BF16", {1024,3072}, 474780944, 6291456}},
{"model.layers.13.mlp.up_proj.weight", {"BF16", {1024,3072}, 481072400, 6291456}},
{"model.layers.13.post_attention_layernorm.weight", {"BF16", {1024}, 487363856, 2048}},
{"model.layers.13.self_attn.k_norm.weight", {"BF16", {128}, 487365904, 256}},
{"model.layers.13.self_attn.k_proj.weight", {"BF16", {1024,1024}, 487366160, 2097152}},
{"model.layers.13.self_attn.o_proj.weight", {"BF16", {2048,1024}, 489463312, 4194304}},
{"model.layers.13.self_attn.q_norm.weight", {"BF16", {128}, 493657616, 256}},
{"model.layers.13.self_attn.q_proj.weight", {"BF16", {1024,2048}, 493657872, 4194304}},
{"model.layers.13.self_attn.v_proj.weight", {"BF16", {1024,1024}, 497852176, 2097152}},
{"model.layers.14.input_layernorm.weight", {"BF16", {1024}, 499949328, 2048}},
{"model.layers.14.mlp.down_proj.weight", {"BF16", {3072,1024}, 499951376, 6291456}},
{"model.layers.14.mlp.gate_proj.weight", {"BF16", {1024,3072}, 506242832, 6291456}},
{"model.layers.14.mlp.up_proj.weight", {"BF16", {1024,3072}, 512534288, 6291456}},
{"model.layers.14.post_attention_layernorm.weight", {"BF16", {1024}, 518825744, 2048}},
{"model.layers.14.self_attn.k_norm.weight", {"BF16", {128}, 518827792, 256}},
{"model.layers.14.self_attn.k_proj.weight", {"BF16", {1024,1024}, 518828048, 2097152}},
{"model.layers.14.self_attn.o_proj.weight", {"BF16", {2048,1024}, 520925200, 4194304}},
{"model.layers.14.self_attn.q_norm.weight", {"BF16", {128}, 525119504, 256}},
{"model.layers.14.self_attn.q_proj.weight", {"BF16", {1024,2048}, 525119760, 4194304}},
{"model.layers.14.self_attn.v_proj.weight", {"BF16", {1024,1024}, 529314064, 2097152}},
{"model.layers.15.input_layernorm.weight", {"BF16", {1024}, 531411216, 2048}},
{"model.layers.15.mlp.down_proj.weight", {"BF16", {3072,1024}, 531413264, 6291456}},
{"model.layers.15.mlp.gate_proj.weight", {"BF16", {1024,3072}, 537704720, 6291456}},
{"model.layers.15.mlp.up_proj.weight", {"BF16", {1024,3072}, 543996176, 6291456}},
{"model.layers.15.post_attention_layernorm.weight", {"BF16", {1024}, 550287632, 2048}},
{"model.layers.15.self_attn.k_norm.weight", {"BF16", {128}, 550289680, 256}},
{"model.layers.15.self_attn.k_proj.weight", {"BF16", {1024,1024}, 550289936, 2097152}},
{"model.layers.15.self_attn.o_proj.weight", {"BF16", {2048,1024}, 552387088, 4194304}},
{"model.layers.15.self_attn.q_norm.weight", {"BF16", {128}, 556581392, 256}},
{"model.layers.15.self_attn.q_proj.weight", {"BF16", {1024,2048}, 556581648, 4194304}},
{"model.layers.15.self_attn.v_proj.weight", {"BF16", {1024,1024}, 560775952, 2097152}},
{"model.layers.16.input_layernorm.weight", {"BF16", {1024}, 562873104, 2048}},
{"model.layers.16.mlp.down_proj.weight", {"BF16", {3072,1024}, 562875152, 6291456}},
{"model.layers.16.mlp.gate_proj.weight", {"BF16", {1024,3072}, 569166608, 6291456}},
{"model.layers.16.mlp.up_proj.weight", {"BF16", {1024,3072}, 575458064, 6291456}},
{"model.layers.16.post_attention_layernorm.weight", {"BF16", {1024}, 581749520, 2048}},
{"model.layers.16.self_attn.k_norm.weight", {"BF16", {128}, 581751568, 256}},
{"model.layers.16.self_attn.k_proj.weight", {"BF16", {1024,1024}, 581751824, 2097152}},
{"model.layers.16.self_attn.o_proj.weight", {"BF16", {2048,1024}, 583848976, 4194304}},
{"model.layers.16.self_attn.q_norm.weight", {"BF16", {128}, 588043280, 256}},
{"model.layers.16.self_attn.q_proj.weight", {"BF16", {1024,2048}, 588043536, 4194304}},
{"model.layers.16.self_attn.v_proj.weight", {"BF16", {1024,1024}, 592237840, 2097152}},
{"model.layers.17.input_layernorm.weight", {"BF16", {1024}, 594334992, 2048}},
{"model.layers.17.mlp.down_proj.weight", {"BF16", {3072,1024}, 594337040, 6291456}},
{"model.layers.17.mlp.gate_proj.weight", {"BF16", {1024,3072}, 600628496, 6291456}},
{"model.layers.17.mlp.up_proj.weight", {"BF16", {1024,3072}, 606919952, 6291456}},
{"model.layers.17.post_attention_layernorm.weight", {"BF16", {1024}, 613211408, 2048}},
{"model.layers.17.self_attn.k_norm.weight", {"BF16", {128}, 613213456, 256}},
{"model.layers.17.self_attn.k_proj.weight", {"BF16", {1024,1024}, 613213712, 2097152}},
{"model.layers.17.self_attn.o_proj.weight", {"BF16", {2048,1024}, 615310864, 4194304}},
{"model.layers.17.self_attn.q_norm.weight", {"BF16", {128}, 619505168, 256}},
{"model.layers.17.self_attn.q_proj.weight", {"BF16", {1024,2048}, 619505424, 4194304}},
{"model.layers.17.self_attn.v_proj.weight", {"BF16", {1024,1024}, 623699728, 2097152}},
{"model.layers.18.input_layernorm.weight", {"BF16", {1024}, 625796880, 2048}},
{"model.layers.18.mlp.down_proj.weight", {"BF16", {3072,1024}, 625798928, 6291456}},
{"model.layers.18.mlp.gate_proj.weight", {"BF16", {1024,3072}, 632090384, 6291456}},
{"model.layers.18.mlp.up_proj.weight", {"BF16", {1024,3072}, 638381840, 6291456}},
{"model.layers.18.post_attention_layernorm.weight", {"BF16", {1024}, 644673296, 2048}},
{"model.layers.18.self_attn.k_norm.weight", {"BF16", {128}, 644675344, 256}},
{"model.layers.18.self_attn.k_proj.weight", {"BF16", {1024,1024}, 644675600, 2097152}},
{"model.layers.18.self_attn.o_proj.weight", {"BF16", {2048,1024}, 646772752, 4194304}},
{"model.layers.18.self_attn.q_norm.weight", {"BF16", {128}, 650967056, 256}},
{"model.layers.18.self_attn.q_proj.weight", {"BF16", {1024,2048}, 650967312, 4194304}},
{"model.layers.18.self_attn.v_proj.weight", {"BF16", {1024,1024}, 655161616, 2097152}},
{"model.layers.19.input_layernorm.weight", {"BF16", {1024}, 657258768, 2048}},
{"model.layers.19.mlp.down_proj.weight", {"BF16", {3072,1024}, 657260816, 6291456}},
{"model.layers.19.mlp.gate_proj.weight", {"BF16", {1024,3072}, 663552272, 6291456}},
{"model.layers.19.mlp.up_proj.weight", {"BF16", {1024,3072}, 669843728, 6291456}},
{"model.layers.19.post_attention_layernorm.weight", {"BF16", {1024}, 676135184, 2048}},
{"model.layers.19.self_attn.k_norm.weight", {"BF16", {128}, 676137232, 256}},
{"model.layers.19.self_attn.k_proj.weight", {"BF16", {1024,1024}, 676137488, 2097152}},
{"model.layers.19.self_attn.o_proj.weight", {"BF16", {2048,1024}, 678234640, 4194304}},
{"model.layers.19.self_attn.q_norm.weight", {"BF16", {128}, 682428944, 256}},
{"model.layers.19.self_attn.q_proj.weight", {"BF16", {1024,2048}, 682429200, 4194304}},
{"model.layers.19.self_attn.v_proj.weight", {"BF16", {1024,1024}, 686623504, 2097152}},
{"model.layers.2.input_layernorm.weight", {"BF16", {1024}, 688720656, 2048}},
{"model.layers.2.mlp.down_proj.weight", {"BF16", {3072,1024}, 688722704, 6291456}},
{"model.layers.2.mlp.gate_proj.weight", {"BF16", {1024,3072}, 695014160, 6291456}},
{"model.layers.2.mlp.up_proj.weight", {"BF16", {1024,3072}, 701305616, 6291456}},
{"model.layers.2.post_attention_layernorm.weight", {"BF16", {1024}, 707597072, 2048}},
{"model.layers.2.self_attn.k_norm.weight", {"BF16", {128}, 707599120, 256}},
{"model.layers.2.self_attn.k_proj.weight", {"BF16", {1024,1024}, 707599376, 2097152}},
{"model.layers.2.self_attn.o_proj.weight", {"BF16", {2048,1024}, 709696528, 4194304}},
{"model.layers.2.self_attn.q_norm.weight", {"BF16", {128}, 713890832, 256}},
{"model.layers.2.self_attn.q_proj.weight", {"BF16", {1024,2048}, 713891088, 4194304}},
{"model.layers.2.self_attn.v_proj.weight", {"BF16", {1024,1024}, 718085392, 2097152}},
{"model.layers.20.input_layernorm.weight", {"BF16", {1024}, 720182544, 2048}},
{"model.layers.20.mlp.down_proj.weight", {"BF16", {3072,1024}, 720184592, 6291456}},
{"model.layers.20.mlp.gate_proj.weight", {"BF16", {1024,3072}, 726476048, 6291456}},
{"model.layers.20.mlp.up_proj.weight", {"BF16", {1024,3072}, 732767504, 6291456}},
{"model.layers.20.post_attention_layernorm.weight", {"BF16", {1024}, 739058960, 2048}},
{"model.layers.20.self_attn.k_norm.weight", {"BF16", {128}, 739061008, 256}},
{"model.layers.20.self_attn.k_proj.weight", {"BF16", {1024,1024}, 739061264, 2097152}},
{"model.layers.20.self_attn.o_proj.weight", {"BF16", {2048,1024}, 741158416, 4194304}},
{"model.layers.20.self_attn.q_norm.weight", {"BF16", {128}, 745352720, 256}},
{"model.layers.20.self_attn.q_proj.weight", {"BF16", {1024,2048}, 745352976, 4194304}},
{"model.layers.20.self_attn.v_proj.weight", {"BF16", {1024,1024}, 749547280, 2097152}},
{"model.layers.21.input_layernorm.weight", {"BF16", {1024}, 751644432, 2048}},
{"model.layers.21.mlp.down_proj.weight", {"BF16", {3072,1024}, 751646480, 6291456}},
{"model.layers.21.mlp.gate_proj.weight", {"BF16", {1024,3072}, 757937936, 6291456}},
{"model.layers.21.mlp.up_proj.weight", {"BF16", {1024,3072}, 764229392, 6291456}},
{"model.layers.21.post_attention_layernorm.weight", {"BF16", {1024}, 770520848, 2048}},
{"model.layers.21.self_attn.k_norm.weight", {"BF16", {128}, 770522896, 256}},
{"model.layers.21.self_attn.k_proj.weight", {"BF16", {1024,1024}, 770523152, 2097152}},
{"model.layers.21.self_attn.o_proj.weight", {"BF16", {2048,1024}, 772620304, 4194304}},
{"model.layers.21.self_attn.q_norm.weight", {"BF16", {128}, 776814608, 256}},
{"model.layers.21.self_attn.q_proj.weight", {"BF16", {1024,2048}, 776814864, 4194304}},
{"model.layers.21.self_attn.v_proj.weight", {"BF16", {1024,1024}, 781009168, 2097152}},
{"model.layers.22.input_layernorm.weight", {"BF16", {1024}, 783106320, 2048}},
{"model.layers.22.mlp.down_proj.weight", {"BF16", {3072,1024}, 783108368, 6291456}},
{"model.layers.22.mlp.gate_proj.weight", {"BF16", {1024,3072}, 789399824, 6291456}},
{"model.layers.22.mlp.up_proj.weight", {"BF16", {1024,3072}, 795691280, 6291456}},
{"model.layers.22.post_attention_layernorm.weight", {"BF16", {1024}, 801982736, 2048}},
{"model.layers.22.self_attn.k_norm.weight", {"BF16", {128}, 801984784, 256}},
{"model.layers.22.self_attn.k_proj.weight", {"BF16", {1024,1024}, 801985040, 2097152}},
{"model.layers.22.self_attn.o_proj.weight", {"BF16", {2048,1024}, 804082192, 4194304}},
{"model.layers.22.self_attn.q_norm.weight", {"BF16", {128}, 808276496, 256}},
{"model.layers.22.self_attn.q_proj.weight", {"BF16", {1024,2048}, 808276752, 4194304}},
{"model.layers.22.self_attn.v_proj.weight", {"BF16", {1024,1024}, 812471056, 2097152}},
{"model.layers.23.input_layernorm.weight", {"BF16", {1024}, 814568208, 2048}},
{"model.layers.23.mlp.down_proj.weight", {"BF16", {3072,1024}, 814570256, 6291456}},
{"model.layers.23.mlp.gate_proj.weight", {"BF16", {1024,3072}, 820861712, 6291456}},
{"model.layers.23.mlp.up_proj.weight", {"BF16", {1024,3072}, 827153168, 6291456}},
{"model.layers.23.post_attention_layernorm.weight", {"BF16", {1024}, 833444624, 2048}},
{"model.layers.23.self_attn.k_norm.weight", {"BF16", {128}, 833446672, 256}},
{"model.layers.23.self_attn.k_proj.weight", {"BF16", {1024,1024}, 833446928, 2097152}},
{"model.layers.23.self_attn.o_proj.weight", {"BF16", {2048,1024}, 835544080, 4194304}},
{"model.layers.23.self_attn.q_norm.weight", {"BF16", {128}, 839738384, 256}},
{"model.layers.23.self_attn.q_proj.weight", {"BF16", {1024,2048}, 839738640, 4194304}},
{"model.layers.23.self_attn.v_proj.weight", {"BF16", {1024,1024}, 843932944, 2097152}},
{"model.layers.24.input_layernorm.weight", {"BF16", {1024}, 846030096, 2048}},
{"model.layers.24.mlp.down_proj.weight", {"BF16", {3072,1024}, 846032144, 6291456}},
{"model.layers.24.mlp.gate_proj.weight", {"BF16", {1024,3072}, 852323600, 6291456}},
{"model.layers.24.mlp.up_proj.weight", {"BF16", {1024,3072}, 858615056, 6291456}},
{"model.layers.24.post_attention_layernorm.weight", {"BF16", {1024}, 864906512, 2048}},
{"model.layers.24.self_attn.k_norm.weight", {"BF16", {128}, 864908560, 256}},
{"model.layers.24.self_attn.k_proj.weight", {"BF16", {1024,1024}, 864908816, 2097152}},
{"model.layers.24.self_attn.o_proj.weight", {"BF16", {2048,1024}, 867005968, 4194304}},
{"model.layers.24.self_attn.q_norm.weight", {"BF16", {128}, 871200272, 256}},
{"model.layers.24.self_attn.q_proj.weight", {"BF16", {1024,2048}, 871200528, 4194304}},
{"model.layers.24.self_attn.v_proj.weight", {"BF16", {1024,1024}, 875394832, 2097152}},
{"model.layers.25.input_layernorm.weight", {"BF16", {1024}, 877491984, 2048}},
{"model.layers.25.mlp.down_proj.weight", {"BF16", {3072,1024}, 877494032, 6291456}},
{"model.layers.25.mlp.gate_proj.weight", {"BF16", {1024,3072}, 883785488, 6291456}},
{"model.layers.25.mlp.up_proj.weight", {"BF16", {1024,3072}, 890076944, 6291456}},
{"model.layers.25.post_attention_layernorm.weight", {"BF16", {1024}, 896368400, 2048}},
{"model.layers.25.self_attn.k_norm.weight", {"BF16", {128}, 896370448, 256}},
{"model.layers.25.self_attn.k_proj.weight", {"BF16", {1024,1024}, 896370704, 2097152}},
{"model.layers.25.self_attn.o_proj.weight", {"BF16", {2048,1024}, 898467856, 4194304}},
{"model.layers.25.self_attn.q_norm.weight", {"BF16", {128}, 902662160, 256}},
{"model.layers.25.self_attn.q_proj.weight", {"BF16", {1024,2048}, 902662416, 4194304}},
{"model.layers.25.self_attn.v_proj.weight", {"BF16", {1024,1024}, 906856720, 2097152}},
{"model.layers.26.input_layernorm.weight", {"BF16", {1024}, 908953872, 2048}},
{"model.layers.26.mlp.down_proj.weight", {"BF16", {3072,1024}, 908955920, 6291456}},
{"model.layers.26.mlp.gate_proj.weight", {"BF16", {1024,3072}, 915247376, 6291456}},
{"model.layers.26.mlp.up_proj.weight", {"BF16", {1024,3072}, 921538832, 6291456}},
{"model.layers.26.post_attention_layernorm.weight", {"BF16", {1024}, 927830288, 2048}},
{"model.layers.26.self_attn.k_norm.weight", {"BF16", {128}, 927832336, 256}},
{"model.layers.26.self_attn.k_proj.weight", {"BF16", {1024,1024}, 927832592, 2097152}},
{"model.layers.26.self_attn.o_proj.weight", {"BF16", {2048,1024}, 929929744, 4194304}},
{"model.layers.26.self_attn.q_norm.weight", {"BF16", {128}, 934124048, 256}},
{"model.layers.26.self_attn.q_proj.weight", {"BF16", {1024,2048}, 934124304, 4194304}},
{"model.layers.26.self_attn.v_proj.weight", {"BF16", {1024,1024}, 938318608, 2097152}},
{"model.layers.27.input_layernorm.weight", {"BF16", {1024}, 940415760, 2048}},
{"model.layers.27.mlp.down_proj.weight", {"BF16", {3072,1024}, 940417808, 6291456}},
{"model.layers.27.mlp.gate_proj.weight", {"BF16", {1024,3072}, 946709264, 6291456}},
{"model.layers.27.mlp.up_proj.weight", {"BF16", {1024,3072}, 953000720, 6291456}},
{"model.layers.27.post_attention_layernorm.weight", {"BF16", {1024}, 959292176, 2048}},
{"model.layers.27.self_attn.k_norm.weight", {"BF16", {128}, 959294224, 256}},
{"model.layers.27.self_attn.k_proj.weight", {"BF16", {1024,1024}, 959294480, 2097152}},
{"model.layers.27.self_attn.o_proj.weight", {"BF16", {2048,1024}, 961391632, 4194304}},
{"model.layers.27.self_attn.q_norm.weight", {"BF16", {128}, 965585936, 256}},
{"model.layers.27.self_attn.q_proj.weight", {"BF16", {1024,2048}, 965586192, 4194304}},
{"model.layers.27.self_attn.v_proj.weight", {"BF16", {1024,1024}, 969780496, 2097152}},
{"model.layers.3.input_layernorm.weight", {"BF16", {1024}, 971877648, 2048}},
{"model.layers.3.mlp.down_proj.weight", {"BF16", {3072,1024}, 971879696, 6291456}},
{"model.layers.3.mlp.gate_proj.weight", {"BF16", {1024,3072}, 978171152, 6291456}},
{"model.layers.3.mlp.up_proj.weight", {"BF16", {1024,3072}, 984462608, 6291456}},
{"model.layers.3.post_attention_layernorm.weight", {"BF16", {1024}, 990754064, 2048}},
{"model.layers.3.self_attn.k_norm.weight", {"BF16", {128}, 990756112, 256}},
{"model.layers.3.self_attn.k_proj.weight", {"BF16", {1024,1024}, 990756368, 2097152}},
{"model.layers.3.self_attn.o_proj.weight", {"BF16", {2048,1024}, 992853520, 4194304}},
{"model.layers.3.self_attn.q_norm.weight", {"BF16", {128}, 997047824, 256}},
{"model.layers.3.self_attn.q_proj.weight", {"BF16", {1024,2048}, 997048080, 4194304}},
{"model.layers.3.self_attn.v_proj.weight", {"BF16", {1024,1024}, 1001242384, 2097152}},
{"model.layers.4.input_layernorm.weight", {"BF16", {1024}, 1003339536, 2048}},
{"model.layers.4.mlp.down_proj.weight", {"BF16", {3072,1024}, 1003341584, 6291456}},
{"model.layers.4.mlp.gate_proj.weight", {"BF16", {1024,3072}, 1009633040, 6291456}},
{"model.layers.4.mlp.up_proj.weight", {"BF16", {1024,3072}, 1015924496, 6291456}},
{"model.layers.4.post_attention_layernorm.weight", {"BF16", {1024}, 1022215952, 2048}},
{"model.layers.4.self_attn.k_norm.weight", {"BF16", {128}, 1022218000, 256}},
{"model.layers.4.self_attn.k_proj.weight", {"BF16", {1024,1024}, 1022218256, 2097152}},
{"model.layers.4.self_attn.o_proj.weight", {"BF16", {2048,1024}, 1024315408, 4194304}},
{"model.layers.4.self_attn.q_norm.weight", {"BF16", {128}, 1028509712, 256}},
{"model.layers.4.self_attn.q_proj.weight", {"BF16", {1024,2048}, 1028509968, 4194304}},
{"model.layers.4.self_attn.v_proj.weight", {"BF16", {1024,1024}, 1032704272, 2097152}},
{"model.layers.5.input_layernorm.weight", {"BF16", {1024}, 1034801424, 2048}},
{"model.layers.5.mlp.down_proj.weight", {"BF16", {3072,1024}, 1034803472, 6291456}},
{"model.layers.5.mlp.gate_proj.weight", {"BF16", {1024,3072}, 1041094928, 6291456}},
{"model.layers.5.mlp.up_proj.weight", {"BF16", {1024,3072}, 1047386384, 6291456}},
{"model.layers.5.post_attention_layernorm.weight", {"BF16", {1024}, 1053677840, 2048}},
{"model.layers.5.self_attn.k_norm.weight", {"BF16", {128}, 1053679888, 256}},
{"model.layers.5.self_attn.k_proj.weight", {"BF16", {1024,1024}, 1053680144, 2097152}},
{"model.layers.5.self_attn.o_proj.weight", {"BF16", {2048,1024}, 1055777296, 4194304}},
{"model.layers.5.self_attn.q_norm.weight", {"BF16", {128}, 1059971600, 256}},
{"model.layers.5.self_attn.q_proj.weight", {"BF16", {1024,2048}, 1059971856, 4194304}},
{"model.layers.5.self_attn.v_proj.weight", {"BF16", {1024,1024}, 1064166160, 2097152}},
{"model.layers.6.input_layernorm.weight", {"BF16", {1024}, 1066263312, 2048}},
{"model.layers.6.mlp.down_proj.weight", {"BF16", {3072,1024}, 1066265360, 6291456}},
{"model.layers.6.mlp.gate_proj.weight", {"BF16", {1024,3072}, 1072556816, 6291456}},
{"model.layers.6.mlp.up_proj.weight", {"BF16", {1024,3072}, 1078848272, 6291456}},
{"model.layers.6.post_attention_layernorm.weight", {"BF16", {1024}, 1085139728, 2048}},
{"model.layers.6.self_attn.k_norm.weight", {"BF16", {128}, 1085141776, 256}},
{"model.layers.6.self_attn.k_proj.weight", {"BF16", {1024,1024}, 1085142032, 2097152}},
{"model.layers.6.self_attn.o_proj.weight", {"BF16", {2048,1024}, 1087239184, 4194304}},
{"model.layers.6.self_attn.q_norm.weight", {"BF16", {128}, 1091433488, 256}},
{"model.layers.6.self_attn.q_proj.weight", {"BF16", {1024,2048}, 1091433744, 4194304}},
{"model.layers.6.self_attn.v_proj.weight", {"BF16", {1024,1024}, 1095628048, 2097152}},
{"model.layers.7.input_layernorm.weight", {"BF16", {1024}, 1097725200, 2048}},
{"model.layers.7.mlp.down_proj.weight", {"BF16", {3072,1024}, 1097727248, 6291456}},
{"model.layers.7.mlp.gate_proj.weight", {"BF16", {1024,3072}, 1104018704, 6291456}},
{"model.layers.7.mlp.up_proj.weight", {"BF16", {1024,3072}, 1110310160, 6291456}},
{"model.layers.7.post_attention_layernorm.weight", {"BF16", {1024}, 1116601616, 2048}},
{"model.layers.7.self_attn.k_norm.weight", {"BF16", {128}, 1116603664, 256}},
{"model.layers.7.self_attn.k_proj.weight", {"BF16", {1024,1024}, 1116603920, 2097152}},
{"model.layers.7.self_attn.o_proj.weight", {"BF16", {2048,1024}, 1118701072, 4194304}},
{"model.layers.7.self_attn.q_norm.weight", {"BF16", {128}, 1122895376, 256}},
{"model.layers.7.self_attn.q_proj.weight", {"BF16", {1024,2048}, 1122895632, 4194304}},
{"model.layers.7.self_attn.v_proj.weight", {"BF16", {1024,1024}, 1127089936, 2097152}},
{"model.layers.8.input_layernorm.weight", {"BF16", {1024}, 1129187088, 2048}},
{"model.layers.8.mlp.down_proj.weight", {"BF16", {3072,1024}, 1129189136, 6291456}},
{"model.layers.8.mlp.gate_proj.weight", {"BF16", {1024,3072}, 1135480592, 6291456}},
{"model.layers.8.mlp.up_proj.weight", {"BF16", {1024,3072}, 1141772048, 6291456}},
{"model.layers.8.post_attention_layernorm.weight", {"BF16", {1024}, 1148063504, 2048}},
{"model.layers.8.self_attn.k_norm.weight", {"BF16", {128}, 1148065552, 256}},
{"model.layers.8.self_attn.k_proj.weight", {"BF16", {1024,1024}, 1148065808, 2097152}},
{"model.layers.8.self_attn.o_proj.weight", {"BF16", {2048,1024}, 1150162960, 4194304}},
{"model.layers.8.self_attn.q_norm.weight", {"BF16", {128}, 1154357264, 256}},
{"model.layers.8.self_attn.q_proj.weight", {"BF16", {1024,2048}, 1154357520, 4194304}},
{"model.layers.8.self_attn.v_proj.weight", {"BF16", {1024,1024}, 1158551824, 2097152}},
{"model.layers.9.input_layernorm.weight", {"BF16", {1024}, 1160648976, 2048}},
{"model.layers.9.mlp.down_proj.weight", {"BF16", {3072,1024}, 1160651024, 6291456}},
{"model.layers.9.mlp.gate_proj.weight", {"BF16", {1024,3072}, 1166942480, 6291456}},
{"model.layers.9.mlp.up_proj.weight", {"BF16", {1024,3072}, 1173233936, 6291456}},
{"model.layers.9.post_attention_layernorm.weight", {"BF16", {1024}, 1179525392, 2048}},
{"model.layers.9.self_attn.k_norm.weight", {"BF16", {128}, 1179527440, 256}},
{"model.layers.9.self_attn.k_proj.weight", {"BF16", {1024,1024}, 1179527696, 2097152}},
{"model.layers.9.self_attn.o_proj.weight", {"BF16", {2048,1024}, 1181624848, 4194304}},
{"model.layers.9.self_attn.q_norm.weight", {"BF16", {128}, 1185819152, 256}},
{"model.layers.9.self_attn.q_proj.weight", {"BF16", {1024,2048}, 1185819408, 4194304}},
{"model.layers.9.self_attn.v_proj.weight", {"BF16", {1024,1024}, 1190013712, 2097152}},
{"model.norm.weight", {"BF16", {1024}, 1192110864, 2048}},
{"position_embeddings.cos", {"BF16", {128,512,1}, 1192112912, 131072}},
{"position_embeddings.sin", {"BF16", {128,512,1}, 1192243984, 131072}},
{"score.weight", {"BF16", {1024,69}, 1192375056, 141312}}};

#define WEIGHT_SCHEMA_NORMAL  0
#define WEIGHT_SCHEMA_LINEAR  1
#define WEIGHT_SCHEMA_MATMUL  2

class model_weights_c
{
	FILE* fp;
public:
	model_weights_c(){
		fp = fopen("model.safetensors", "rb");
	}
	~model_weights_c(){
		fclose(this->fp);
	}
	unsigned char* get(const char* name, int flag)
	{
		struct tensor_meta meta = model_weights_raw[name];
        fseeko64(this->fp, meta.data_offsets, SEEK_SET);
        unsigned char* data = (unsigned char*)aligned_alloc(64, meta.data_length);
        fread(data, meta.data_length, 1, this->fp);
		if (flag == WEIGHT_SCHEMA_NORMAL)
		{
			return data;
		}else if (flag == WEIGHT_SCHEMA_LINEAR)
		{
			unsigned char* data2 = (unsigned char*)aligned_alloc(64, meta.data_length);
			amx_matrix_tranpose((bf16*)data, meta.shape[0], meta.shape[1], meta.shape[0], (bf16*)data2, meta.shape[1]);
			//amx_convert_linear_weights((bf16*)data2, (bf16*)data, meta.shape[0], meta.shape[1]);
			free(data);
			return data2;
		}else if (flag == WEIGHT_SCHEMA_MATMUL)
		{
			unsigned char* data2 = (unsigned char*)aligned_alloc(64, meta.data_length);
			amx_convert_matmul_weights((bf16*)data2, (bf16*)data, meta.shape[0], meta.shape[1]);
			free(data);
			return data2;
		}
		return 0;
	}
};
class model_weights_c model_weights_g;
